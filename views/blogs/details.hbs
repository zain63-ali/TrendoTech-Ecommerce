<div class="container my-5">
    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-8">
            <!-- Breadcrumb -->
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="/">Home</a></li>
                    <li class="breadcrumb-item"><a href="/blogs">Blogs</a></li>
                    <li class="breadcrumb-item"><a href="/blogs?category={{blog.category}}">{{blog.category}}</a></li>
                    <li class="breadcrumb-item active" aria-current="page">{{blog.title}}</li>
                </ol>
            </nav>

            <!-- Blog Post -->
            <article class="blog-post">
                <h1 class="mb-3">{{blog.title}}</h1>
                
                <div class="d-flex mb-4 align-items-center">
                    <span class="ms-auto text-muted">
                        <i class="fas fa-user me-1"></i> {{#if blog.author}}{{blog.author.name}}{{else}}Unknown Author{{/if}} | 
                        <i class="fas fa-calendar me-1"></i> {{formatDate blog.createdAt}} |
                        <i class="fas fa-eye me-1"></i> {{blog.views}} views
                    </span>
                </div>
                
                <img src="{{blog.imageUrl}}" alt="{{blog.title}}" class="img-fluid rounded mb-4 w-100" style="max-height: 400px; object-fit: cover;">
                
                <div class="blog-content mb-5">
                    {{{blog.content}}}
                </div>
                
                <!-- Social Share -->
                <div class="card mb-5">
                    <div class="card-body">
                        <h5 class="card-title">Share this post</h5>
                        <div class="d-flex gap-2">
                            <a href="https://www.facebook.com/sharer/sharer.php?u={{encodeURIComponent currentUrl}}" target="_blank" class="btn btn-outline-primary">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a href="https://twitter.com/intent/tweet?url={{encodeURIComponent currentUrl}}&text={{encodeURIComponent blog.title}}" target="_blank" class="btn btn-outline-info">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="https://www.linkedin.com/shareArticle?mini=true&url={{encodeURIComponent currentUrl}}&title={{encodeURIComponent blog.title}}" target="_blank" class="btn btn-outline-secondary">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <a href="mailto:?subject={{encodeURIComponent blog.title}}&body={{encodeURIComponent currentUrl}}" class="btn btn-outline-danger">
                                <i class="fas fa-envelope"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- Related Posts -->
                {{#if relatedPosts.length}}
                <div class="related-posts">
                    <h3 class="mb-4">Related Posts</h3>
                    <div class="row row-cols-1 row-cols-md-3 g-4">
                        {{#each relatedPosts}}
                        <div class="col">
                            <div class="card h-100">
                                <img src="{{this.imageUrl}}" class="card-img-top" alt="{{this.title}}" style="height: 180px; object-fit: cover;">
                                <div class="card-body">
                                    <h5 class="card-title">
                                        <a href="/blogs/{{this._id}}" class="text-decoration-none text-dark">{{this.title}}</a>
                                    </h5>
                                    <p class="card-text small">{{truncate this.summary 80}}</p>
                                </div>
                                <div class="card-footer">
                                    <small class="text-muted">
                                        By {{#if this.author}}{{this.author.name}}{{else}}Unknown Author{{/if}} | {{formatDate this.createdAt}}
                                    </small>
                                </div>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                </div>
                {{/if}}
            </article>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Search -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Search</h5>
                </div>
                <div class="card-body">
                    <form action="/blogs" method="GET">
                        <div class="input-group">
                            <input type="text" class="form-control" name="search" placeholder="Search blogs...">
                            <button class="btn btn-primary" type="submit">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Categories -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Categories</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <a href="/blogs" class="text-decoration-none text-dark">All Categories</a>
                        </li>
                        {{#each categories}}
                        <li class="list-group-item d-flex justify-content-between align-items-center {{#if (eq ../blog.category this)}}active{{/if}}">
                            <a href="/blogs?category={{this}}" class="text-decoration-none {{#if (eq ../blog.category this)}}text-white{{else}}text-dark{{/if}}">
                                {{this}}
                            </a>
                        </li>
                        {{/each}}
                    </ul>
                </div>
            </div>

            <!-- Recent Posts -->
            <div class="card mb-4">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Recent Posts</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        {{#each recentPosts}}
                        <li class="list-group-item p-2">
                            <a href="/blogs/{{this._id}}" class="text-decoration-none">
                                <div class="d-flex justify-content-between">
                                    <div>{{this.title}}</div>
                                    <small class="text-muted">{{formatDate this.createdAt}}</small>
                                </div>
                            </a>
                        </li>
                        {{/each}}
                    </ul>
                </div>
            </div>

            <!-- Admin Actions -->
            {{#if (eq user.role 'admin')}}
            <div class="card mb-4">
                <div class="card-header bg-dark text-white">
                    <h5 class="mb-0">Admin Actions</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="/blogs/admin/edit/{{blog._id}}" class="btn btn-primary">
                            <i class="fas fa-edit me-2"></i> Edit Blog Post
                        </a>
                        <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal">
                            <i class="fas fa-trash me-2"></i> Delete Blog Post
                        </button>
                    </div>
                </div>
            </div>

            <!-- Delete Modal -->
            <div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title">Confirm Delete</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body">
                            Are you sure you want to delete <strong>{{blog.title}}</strong>?
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                            <form action="/blogs/admin/delete/{{blog._id}}" method="POST">
                                <button type="submit" class="btn btn-danger">Delete</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            {{/if}}
        </div>
    </div>
</div> 